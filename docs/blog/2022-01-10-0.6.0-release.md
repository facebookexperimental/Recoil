---
title: Recoil 0.6
---

Recoil 0.6 introduces improved support for React 18 along with new APIs, fixes, and optimizations.

## React 18

Recoil 0.6 uses the latest APIs from React 18 for improved safety to avoid "tearing" and provide optimizations that reduce unnecessary work.  The release is compatible with [`<React.StrictMode>`](https://reactjs.org/docs/strict-mode.html), which is useful for testing and identifying potential issues for concurrent rendering.  Making Recoil and React state changes in the same callback are now also synchronized so they will both be updated together with the next render for a consistent view of state.

## New Features

* Recoil Callbacks
  * [`useRecoilCallback()`](/docs/api-reference/core/useRecoilCallback) can now also refresh selector caches, similar to [`useRecoilRefresher_UNSTABLE()`](/docs/api-reference/core/useRecoilRefresher). ([#1413](https://github.com/facebookexperimental/Recoil/pull/1413))
  * Callbacks from selectors using [`getCallback()`](/docs/api-reference/core/selector#returning-objects-with-callbacks) can now mutate, refresh, and transact state in addition to reading it, similar to [`useRecoilCallback()`](/docs/api-reference/core/useRecoilCallback). ([#1498](https://github.com/facebookexperimental/Recoil/pull/1498))
* Store IDs - A `StoreID` can now be obtained using [`useRecoilStoreID()`](/docs/api-reference/core/useRecoilStoreID) ([#1417](https://github.com/facebookexperimental/Recoil/pull/1417)) or the `storeID` parameter in [atom effects](/docs/guides/atom-effects)  ([#1414](https://github.com/facebookexperimental/Recoil/pull/1414)).
* [`RecoilLoadable.of()`](/docs/api-reference/core/Loadable#examples) and [`RecoilLoadable.all()`](/docs/api-reference/core/Loadable#examples) factories now accept either literal values, async Promises, or Loadables.  This is comparable to `Promise.resolve()` and `Promise.all()`  ([#1455](https://github.com/facebookexperimental/Recoil/pull/1455), [#1442](https://github.com/facebookexperimental/Recoil/pull/1442)).
* Add `.isRetained()` method for Snapshots and check if snapshot is already released when using `.retain()` in development ([#1546](https://github.com/facebookexperimental/Recoil/pull/1546))

## Breaking Changes
- [Atom effect](/docs/guides/atom-effects) initializations takes precedence over `<RecoilRoot initializeState={...}>`. ([#1509](https://github.com/facebookexperimental/Recoil/pull/1509))

## Other Fixes and Optimizations
- Reduce overhead of snapshot cloning
  - Only clone the current snapshot for callbacks if the callback actually uses it. ([#1501](https://github.com/facebookexperimental/Recoil/pull/1501))
  - Cache the cloned snapshots from callbacks unless there was a state change. ([#1533](https://github.com/facebookexperimental/Recoil/pull/1533))
- Fix transitive selector refresh for some cases ([#1409](https://github.com/facebookexperimental/Recoil/pull/1409))
- Atom effects
  - Rename option from `effects_UNSTABLE` to just `effects` as the interface is mostly stabilizing ([#1520](https://github.com/facebookexperimental/Recoil/pull/1520))
  - Run atom effects when atoms are initialized from a set during a transaction from [`useRecoilTransaction_UNSTABLE()`](/docs/api-reference/core/useRecoilTransaction) ([#1466](https://github.com/facebookexperimental/Recoil/pull/1466))
  - Atom effects are cleaned up when initialized by a Snapshot which is released. ([#1511](https://github.com/facebookexperimental/Recoil/pull/1511), [#1532](https://github.com/facebookexperimental/Recoil/pull/1532))
  - Unsubscribe `onSet()` handlers in atom effects when atoms are cleaned up. ([#1509](https://github.com/facebookexperimental/Recoil/pull/1509))
  - Call `onSet()` when atoms are initialized with `<RecoilRoot initializeState={...} >` ([#1519](https://github.com/facebookexperimental/Recoil/pull/1519), [#1511](https://github.com/facebookexperimental/Recoil/pull/1511))
- Avoid extra re-renders in some cases when a component uses a different atom/selector. ([#825](https://github.com/facebookexperimental/Recoil/pull/825))
- `<RecoilRoot>` will only call `initializeState()` once during the initial render. ([#1372](https://github.com/facebookexperimental/Recoil/pull/1372))
